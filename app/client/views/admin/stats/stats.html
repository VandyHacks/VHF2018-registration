<style>
.stacked-bar-graph {
  width: 100%;
  height: 38px;
  color:#414042;
}
.stacked-bar-graph > span {
  display: inline-block;
  height:100%;
  box-sizing: border-box;
  float: left;
  font-weight: bold;
  font-family: arial, sans-serif;
  padding: 10px;
}

.bar-1 {
  background: #A7A9AC;
}
.bar-2 {
  background: #F7B334;
}

.bar-3 {
  background: #208230;
}

.bar-4 {
  background: #D23030;
}
</style>


<div id="stats">

  <div class="ui green segment" ng-class="{'loading': loading}">
    <div class="ui header">
      Stats
    </div>
    <div class="content">
      <em> Last updated: {{fromNow(stats.lastUpdated)}}</em>
      <div class="ui list">
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Total Users
            </strong> :
            {{stats.total}}
          </div>
        </div>
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Verified Users
            </strong> :
            {{stats.verified}} ({{stats.verified / stats.total * 100 | number: 1}}%)
          </div>
        </div>
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Submitted Users
            </strong> :
            {{stats.submitted}} ({{stats.submitted / stats.total * 100 | number: 1}}%)
          </div>
        </div>
        <div class="ui divider"></div>
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Admitted
            </strong> :
            {{stats.admitted}}
          </div>
        </div>
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Confirmed (Total)
            </strong> :
            {{stats.confirmed}}
          </div>
        </div>
        <div class="item">
          <i class="green circle check icon"></i>
          <div class="content">
            <strong>
              Confirmed (Vanderbilt)
            </strong> :
            {{stats.confirmedVandy}}
          </div>
        </div>
        <div class="item">
          <i class="circle red icon"></i>
          <div class="content">
            <strong>
              Declined
            </strong> :
            {{stats.declined}}
          </div>
        </div>

        <div class="ui divider"></div>

        <div class="item">
          <i class="child icon"></i>
          <div class="content">
            <strong>
              Unisex shirt sizes:
            </strong>
            XS ({{stats.shirtSizes['XS']}})&emsp;
            S ({{stats.shirtSizes['S']}})&emsp;
            M ({{stats.shirtSizes['M']}})&emsp;
            L ({{stats.shirtSizes['L']}})&emsp;
            XL ({{stats.shirtSizes['XL']}})&emsp;
            XXL ({{stats.shirtSizes['XXL']}})&emsp;
          </div>
        </div>

        <div class="item">
          <i class="child icon"></i>
          <div class="content">
            <strong>
              Women's shirt sizes:
            </strong>
            XS ({{stats.shirtSizes['WXS']}})&emsp;
            S ({{stats.shirtSizes['WS']}})&emsp;
            M ({{stats.shirtSizes['WM']}})&emsp;
            L ({{stats.shirtSizes['WL']}})&emsp;
            XL ({{stats.shirtSizes['WXL']}})&emsp;
            XXL ({{stats.shirtSizes['WXXL']}})&emsp;
          </div>
        </div>

        <div class="ui divider"></div>
          <div class="item">
            <i class="phone icon"></i>
            <div class="content">
              <strong>
                SMS permission:
              </strong>{{stats.smsPermission}}
            </div>
          </div>
          
        <div class="ui divider"></div>
          <div class="item">
            <i class="lightning icon"></i>
            <div class="content">
              <strong>
                Lightning talk volunteers:
              </strong>{{stats.lightningTalks}}
            </div>
          </div>

        <div class="ui divider"></div>

        <div class="item">
          <i class="green money icon"></i>
          <div class="content">
            <strong>
              Total Reimbursements:
            </strong>{{stats.reimbursementTotal}}
          </div>
        </div>

        <div class="item">
          <i class="frown icon"></i>
          <div class="content">
            <strong>
              Still Need Reimbursement:
            </strong>{{stats.reimbursementMissing}}
          </div>
        </div>

        <div class="ui divider"></div>

        <div class="item">
          <i class="plug icon"></i>
          <div class="content">
            <strong>
              Need/Want Hardware:
            </strong>{{stats.wantsHardware}}
          </div>
        </div>

        <div class="ui divider"></div>

        <div class="item">
          <div> Volunteers </div>
        </div>
        <div class="item">
          <div>
            <strong> Volunteers (submitted): </strong> {{stats.volunteerSubmitted}}
          </div>
        </div>
        <div class="item">
          <div>
            <strong> Volunteers (accepted): </strong> {{stats.volunteerAdmitted}}
          </div>
        </div>
        <div class="item">
          <div>
            <strong> Volunteers (confirmed): </strong> {{stats.volunteerConfirmed}}
          </div>
        </div>

        <div class="ui divider"></div>

        <div class="item">
          <i class="food icon"></i>
          <div class="content">
            <strong>
              Dietary Restrictions:
            </strong>

          </div>
          <div class="item" ng-repeat="restriction in stats.dietaryRestrictions | orderBy: '-count'">
            <div>
              {{restriction.name}}: {{restriction.count}}
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="ui pink segment" ng-class="{'loading': loading}">
    <div class="ui header">
      Demographics
    </div>
    <div class="ui list">
      <div class="item">
        <i class="users icon"></i>
        <div class="content">
          <strong>Total users</strong>: {{stats.total}}
        </div>
      </div>
      <div class="item">
        <i class="female icon"></i>
        <div class="content">
          <strong>Female</strong>: {{stats.demo.gender['F']}} ({{stats.demo.gender['F'] / stats.submitted * 100 |
          number:1}}%)
        </div>
      </div>
      <div class="item">
        <i class="male icon"></i>
        <div class="content">
          <strong>Male</strong>: {{stats.demo.gender['M']}} ({{stats.demo.gender['M'] / stats.submitted * 100 |
          number:1}}%)
        </div>
      </div>
      <div class="item">
        <i class="other gender icon"></i>
        <div class="content">
          <strong>Other</strong>: {{stats.demo.gender['O']}} ({{stats.demo.gender['O'] / stats.submitted * 100 |
          number:1}}%)
        </div>
      </div>
      <div class="item">
        <i class="question icon"></i>
        <div class="content">
          <strong>Did not respond</strong>: {{stats.demo.gender['N']}} ({{stats.demo.gender['N'] / stats.submitted * 100 |
          number:1 }}%)
        </div>
      </div>
    </div>
    <div class="ui divider"></div>
    <div class="ui list">
      <div class="item">
        <strong>Fresh:</strong> {{stats.demo.year['2022']}} ({{stats.demo.year['2022'] / stats.submitted * 100 | number:
        1}}%)
      </div>
      <div class="item">
        <strong>Soph:</strong> {{stats.demo.year['2021']}} ({{stats.demo.year['2021'] / stats.submitted * 100 | number:
        1}}%)
      </div>
      <div class="item">
        <strong>Junior:</strong> {{stats.demo.year['2020']}} ({{stats.demo.year['2020'] / stats.submitted * 100 | number:
        1}}%)
      </div>
      <div class="item">
        <strong>Senior:</strong> {{stats.demo.year['2019']}} ({{stats.demo.year['2019'] / stats.submitted * 100 | number:
        1}}%)
      </div>
      <div class="item">
        <strong>Graduating in 2018:</strong> {{stats.demo.year['2018']}} ({{stats.demo.year['2018'] / stats.submitted * 100
        | number: 1}}%)
      </div>
    </div>
    <div class="ui divider"></div>
    <h3>Majors: </h3>
    <div>
      Computer Science: {{stats.majors['Computer Science']}}
    </div>
    <div>
      Computer Engineering: {{stats.majors['Computer Engineering']}}
    </div>
    <div>
      Mathematics: {{stats.majors['Mathematics']}}
    </div>
    <div class="ui divider"></div>
    <h3>Schools (top {{stats.demo.topSchools.length}})</h3>
    <div class="ui list">
      <div class="item" ng-repeat="school in stats.demo.topSchools | orderBy: '-count'">
        <strong>{{school.email}}</strong> : {{school.count}} ({{school.count / stats.submitted * 100 | number: 1}}%)&emsp;
        <div class="stacked-bar-graph">
          <span style="width:{{100 * (school.stats.submitted - school.stats.admitted - school.stats.confirmed - school.stats.declined)/school.stats.submitted}}%" class="bar-1">
            Submitted: {{school.stats.submitted}}
          </span>
          <span style="width:{{100 * (school.stats.admitted - school.stats.confirmed - school.stats.declined)/school.stats.submitted}}" class="bar-2">
            Admitted: {{school.stats.admitted}}
          </span>
          <span style="width:{{100 * school.stats.confirmed/school.stats.submitted}}%" class="bar-3">
            Confirmed: {{school.stats.confirmed}}
          </span>
          <span style="width:{{100 * school.stats.declined/school.stats.submitted}}%" class="bar-4">
            Declined: {{school.stats.declined}}
          </span>
          <div class="ui divider"></div>
        </div>
      </div>
    </div>


    <button ng-click="showMore = !showMore">Show {{stats.demo.nonTopSchools.length}} more</button>
    <table ng-show="showMore" class="ui celled selectable compact users table">
      <thead>
        <tr>
          <th>School</th>
          <th>Stats</th>
        </tr>
      </thead>
      <tbody>
        <tr class="item" ng-repeat="school in stats.demo.nonTopSchools | orderBy: '-count'">
          <td>
            <strong>
              {{school.email}}
            </strong>
          </td>
          <td>{{school.stats.submitted}}, {{school.stats.admitted}}, {{school.stats.confirmed}},
            {{school.stats.declined}}</td>
        </tr>
      </tbody>
    </table>

  </div>

  <!--   <div
    class="ui purple segment"
    ng-class="{'loading': loading}">
    <div class="ui header">
      Team Names
    </div>
    <div class="ui list">
      <div
        class="item"
        ng-repeat="team in stats.teams | orderBy: 'name'">
        <div class="header">
          {{team.name}}
        </div>
        {{team.users.join(', ')}}
      </div>
    </div>
  </div> -->

</div>
